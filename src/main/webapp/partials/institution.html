<div class="container">
    <h1 class="page-header">Institution/Organization Unit</h1>
    <ol class="breadcrumb" ng-if="browseInstOrgObjectList.length > 0">
        <li class="breadcrumb-item" ng-repeat="item in browseInstOrgObjectList" ng-class="$last ? 'active' : ''">{{(item.name| languageItem : 'en').text}}</li>
    </ol>
    <div class="panel panel-default" ng-show="showAddInstitutionForm">
        <div class="panel-heading"><h2>Add Institution</h2></div>
        <div class="panel-body">
            <form class="form-horizontal"  ng-submit="addInstitution()">
                <div class="form-group">
                    <label class="control-label mandatory-control col-sm-2" for="instid">Institution Id</label>
                    <div class="col-sm-10">
                        <input id="instid" type="text" class="form-control" placeholder="Enter SCHAC identifier" ng-model="newInstitution.institutionId" required="required">
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2">Other Id</label>
                    <div class="col-sm-10" ng-if="!newInstitution.otherId || newInstitution.otherId.length === 0">
                    </div>
                    <div ng-repeat="otherId in newInstitution.otherId">
                        <div class="col-sm-2" ng-if="$index > 0"></div>
                        <div class="col-sm-5">
                            <input type="text" class="form-control" placeholder="Type" ng-model="otherId.idType" required="required"/>
                        </div>
                        <div class="col-sm-5">
                            <input type="text" class="form-control" placeholder="Value" ng-model="otherId.idValue" required="required" />
                        </div>
                    </div>
                    <div class="col-sm-2"></div>
                    <div class="col-sm-10">
                        <button type="button" class="btn btn-default" ng-click="addOtherIdForInstitution()">
                            <i class="glyphicon glyphicon-plus-sign"></i>
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label mandatory-control col-sm-2" for="name">Name</label>
                    <div ng-repeat="name in newInstitution.name">
                        <div class="col-sm-2" ng-if="$index > 0"></div>
                        <div class="col-sm-8">
                            <input id="name" type="text" class="form-control" placeholder="Enter name" ng-model="name.text" required="required">
                        </div>
                        <div class="col-sm-2">
                            <input id="name" type="text" class="form-control" placeholder="Language code" ng-model="name.lang" required="required">
                        </div>
                    </div>
                    <div class="col-sm-2"></div>
                    <div class="col-sm-10">
                        <button type="button" class="btn btn-default" ng-click="addNameForInstitution()">
                            <i class="glyphicon glyphicon-plus-sign"></i>
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="abbreviation">Abbreviation</label>
                    <div class="col-sm-10">
                        <input id="abbreviation" type="text" class="form-control" placeholder="Enter abbreviation" ng-model="newInstitution.abbreviation">
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="logo-url">Logo URL</label>
                    <div class="col-sm-10">
                        <input id="logo-url" type="text" class="form-control" placeholder="Enter logo URL" ng-model="newInstitution.logoUrl">
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="address-line">Address line</label>
                    <div class="col-sm-10">
                        <input id="address-line" type="text" class="form-control" placeholder="Enter address line" ng-model="newInstitution.addressLine">
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="building-number">Building number</label>
                    <div class="col-sm-3">
                        <input id="building-number" type="text" class="form-control" placeholder="Enter building number" ng-model="newInstitution.factSheet.contactDetails.streetAddress.buildingNumber">
                    </div>
                    <div class="col-sm-7"></div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="building-name">Building name</label>
                    <div class="col-sm-10">
                        <input id="building-name" type="text" class="form-control" placeholder="Enter building name" ng-model="newInstitution.factSheet.contactDetails.streetAddress.buildingName">
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="street-name">Street name</label>
                    <div class="col-sm-10">
                        <input id="street-name" type="text" class="form-control" placeholder="Enter street name" ng-model="newInstitution.factSheet.contactDetails.streetAddress.streetName">
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="unit">Unit</label>
                    <div class="col-sm-10">
                        <input id="unit" type="text" class="form-control" placeholder="Enter unit" ng-model="newInstitution.factSheet.contactDetails.streetAddress.unit">
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="floor">Floor</label>
                    <div class="col-sm-3">
                        <input id="floor" type="text" class="form-control" placeholder="Enter floor" ng-model="newInstitution.factSheet.contactDetails.streetAddress.floor">
                    </div>
                    <div class="col-sm-7"></div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="box">Post office box</label>
                    <div class="col-sm-10">
                        <input id="box" type="text" class="form-control" placeholder="Enter post office box" ng-model="newInstitution.factSheet.contactDetails.streetAddress.postOfficeBox">
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="delivery-point-code">Delivery point code</label>
                    <div class="col-sm-10">
                        <input id="delivery-point-code" type="text" class="form-control" placeholder="Enter delivery point code" ng-model="newInstitution.deliveryPointCode">
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="postal-code">Postal code</label>
                    <div class="col-sm-3">
                        <input id="postal-code" type="text" class="form-control" placeholder="Enter postal code" ng-model="newInstitution.factSheet.contactDetails.streetAddress.postalCode">
                    </div>
                    <div class="col-sm-7"></div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="locality">City</label>
                    <div class="col-sm-10">
                        <input id="locality" type="text" class="form-control" placeholder="Enter city/locality" ng-model="newInstitution.factSheet.contactDetails.streetAddress.locality">
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="region">Region</label>
                    <div class="col-sm-10">
                        <input id="region" type="text" class="form-control" placeholder="Enter region" ng-model="newInstitution.factSheet.contactDetails.streetAddress.region">
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="country">Country code</label>
                    <div class="col-sm-3">
                        <input id="country" type="text" class="form-control" placeholder="Enter country code" ng-model="newInstitution.factSheet.contactDetails.streetAddress.country">
                    </div>
                    <div class="col-sm-7"></div>
                </div>
                <div class="input-group">
                    <div class="btn-group">
                        <button type="submit" class="btn btn-default">
                            <i class="glyphicon glyphicon-ok-circle"></i> Save
                        </button>
                        <button type="button" class="btn btn-default" ng-click="cancelAddForm()">
                            <i class="glyphicon glyphicon-remove-circle"></i> Cancel
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <div class="panel panel-default" ng-show="showAddOrganizationUnitForm">
        <div class="panel-heading"><h2>Add Organization Unit</h2></div>
        <div class="panel-body">
            <form class="form-horizontal"  ng-submit="addOrganizationUnit()">
                <div class="form-group">
                    <label class="control-label mandatory-control col-sm-2" for="oouid">Org. Unit Id:</label>
                    <div class="col-sm-10">
                        <input id="oouid" type="text" class="form-control" placeholder="Enter organization unit identifier" ng-model="newOrganizationUnit.organizationUnitId" required="required">
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2">Other Id:</label>
                    <div class="col-sm-10" ng-if="!newOrganizationUnit.otherId || newOrganizationUnit.otherId.length === 0">
                    </div>
                    <div ng-repeat="otherId in newOrganizationUnit.otherId">
                        <div class="col-sm-2" ng-if="$index > 0"></div>
                        <div class="col-sm-5">
                            <input type="text" class="form-control" placeholder="Type" ng-model="otherId.idType" required="required"/>
                        </div>
                        <div class="col-sm-5">
                            <input type="text" class="form-control" placeholder="Value" ng-model="otherId.idValue" required="required" />
                        </div>
                    </div>
                    <div class="col-sm-2"></div>
                    <div class="col-sm-10">
                        <button type="button" class="btn btn-default" ng-click="addOtherIdForOrgUnit()">
                            <i class="glyphicon glyphicon-plus-sign"></i>
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label mandatory-control col-sm-2" for="name">Name</label>
                    <div ng-repeat="name in newOrganizationUnit.name">
                        <div class="col-sm-2" ng-if="$index > 0"></div>
                        <div class="col-sm-8">
                            <input id="name" type="text" class="form-control" placeholder="Enter name" ng-model="name.text" required="required">
                        </div>
                        <div class="col-sm-2">
                            <input id="name" type="text" class="form-control" placeholder="Language code" ng-model="name.lang" required="required">
                        </div>
                    </div>
                    <div class="col-sm-2"></div>
                    <div class="col-sm-10">
                        <button type="button" class="btn btn-default" ng-click="addNameForOrganizationUnit()">
                            <i class="glyphicon glyphicon-plus-sign"></i>
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="address">Address</label>
                    <div class="col-sm-10">
                        <input id="address" type="text" class="form-control" placeholder="Enter address" ng-model="newOrganizationUnit.streetAddressLine" required="required">
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="locality">City</label>
                    <div class="col-sm-10">
                        <input id="locality" type="text" class="form-control" placeholder="Enter city" ng-model="newOrganizationUnit.streetAddress.locality" required="required">
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="country">Country code</label>
                    <div class="col-sm-2">
                        <input id="country" type="text" class="form-control" placeholder="Enter country code" ng-model="newOrganizationUnit.streetAddress.country" required="required">
                    </div>
                    <div class="col-sm-8"></div>
                </div>
                <div class="input-group">
                    <div class="btn-group">
                        <button type="submit" class="btn btn-default">
                            <i class="glyphicon glyphicon-ok-circle"></i> Save
                        </button>
                        <button type="button" class="btn btn-default" ng-click="cancelAddForm()">
                            <i class="glyphicon glyphicon-remove-circle"></i> Cancel
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <div ng-show="!currentInstOrgObject">
        <div class="clearfix">
            <h2 class="pull-left">Institutions</h2>
            <div class="btn-group pull-right" ng-show="!showAddInstitutionForm">
                <button type="submit" class="btn btn-default" ng-click="viewAddForm()">
                    <i class="glyphicon glyphicon-plus-sign"></i>
                </button>
            </div>
        </div>
        <div id="institutionList">
            <div class="input-group">
                <input class="form-control" id="search" name="search" placeholder="Search for" ng-model="query"
                       required="required"/>
                <span class="input-group-btn">
                    <button type="submit" class="btn btn-default">
                        <i class="glyphicon glyphicon-search"></i>
                    </button>
                </span>
            </div>
            <div class="list-group">
                <div ng-repeat="institution in institutions| filter:query" ng-click="setCurrentInstOrgObject(institution)">
                    <a class="list-group-item clearfix">
                        <b>{{(institution.name| languageItem : 'en').text}}</b>
                        <i class="pull-right glyphicon glyphicon-chevron-right"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div ng-show="currentInstOrgObject">
        <h2>{{browseInstOrgObjectList.length === 1 ? 'Institution' : 'Organization Unit'}}</h2>
        <div class="clearfix" ng-class="currentInstOrgObject.organizationUnits.length > 0 ? '' : 'margin-bottom-1em'">
            <div class="col-sm-2 hide-overflow-ellipsis">Id:</div><div class="col-md-10">{{currentInstOrgObject.id}}</div>
            <div ng-repeat="name in currentInstOrgObject.name">
                <div class="col-sm-2 hide-overflow-ellipsis">Name ({{name.lang}}):</div><div class="col-md-10">{{name.text}}</div>
            </div>
            <div ng-if="currentInstOrgObject.abbreviation">
                <div class="col-md-2">Abbreviation:</div><div class="col-md-10 hide-overflow-ellipsis">{{currentInstOrgObject.abbreviation}}</div>
            </div>
            <div ng-if="currentInstOrgObject.logoUrl">
                <div class="col-md-2">Logo URL:</div><div class="col-md-10 hide-overflow-ellipsis">{{currentInstOrgObject.logoUrl}}</div>
            </div>
            <div ng-repeat="otherId in currentInstOrgObject.otherId">
                <div class="col-sm-2 hide-overflow-ellipsis">Other Id ({{otherId.idType}}):</div><div class="col-md-10">{{otherId.idValue}}</div>
            </div>
            <div data-contact-details="currentInstOrgObject.factSheet.contactDetails"></div>
        </div>

        <div ng-if="currentInstOrgObject.organizationUnits.length > 0">
            <div class="clearfix">
                <h3 class="pull-left">Organization Units</h3>
                <div class="btn-group pull-right" ng-show="!showAddOrganizationUnitForm">
                    <button type="submit" class="btn btn-default" ng-click="viewAddForm()">
                        <i class="glyphicon glyphicon-plus-sign"></i>
                    </button>
                </div>
            </div>
            <div class="input-group">
                <input class="form-control" id="search" name="search" placeholder="Search for" ng-model="query2"
                       required="required"/>
                <span class="input-group-btn">
                    <button type="submit" class="btn btn-default">
                        <i class="glyphicon glyphicon-search"></i>
                    </button>
                </span>
            </div>
            <div class="list-group">
                <div ng-repeat="obj in currentInstOrgObject.organizationUnits| filter:query2" ng-click="setCurrentInstOrgObject(obj)">
                    <a class="list-group-item clearfix">
                        <b>{{(obj.name| languageItem : 'en').text}}</b>
                        <i class="pull-right glyphicon glyphicon-chevron-right"></i>
                    </a>
                </div>
            </div>
        </div>
        <button ng-click="backCurrentInstOrgObject()" class="btn btn-default"><i class="glyphicon glyphicon-chevron-left"></i> Back</button>
        <button type="submit" class="btn btn-default" ng-if="!currentInstOrgObject.organizationUnits || currentInstOrgObject.organizationUnits.length === 0" ng-click="viewAddForm()">
            <i class="glyphicon glyphicon-plus-sign"></i> Add Organization Unit
        </button>
    </div>
</div>

